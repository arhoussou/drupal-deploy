<?xml version="1.0"?>
<project name="sudotest" default="main">
 
  <target name="sudotest">
    <!-- Create the currentuser property -->
    <exec command="whoami" outputProperty="currentuser" />
 <echo>utilisateur : ${currentuser} </echo>
    <!-- Set the 'issudo' property to be true if the user is root -->
    <condition property="issudo">
      <equals arg1="${currentuser}" arg2="root" />
    </condition>
 
    <!-- Fail the build if the user is not root -->
    <if>
      <not>
        <equals arg1="${issudo}" arg2="true" />
      </not>
      <then>
        <fail message="You must run this build as sudo!" />
      </then>
    </if>
  </target>
 
  <target name="main" depends="sudotest">
    <echo>Running main target</echo>
  </target>
</project>